<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cloud Browser Pro</title>
    <style>
        body { margin: 0; font-family: system-ui; background: #1a1a1a; color: white; display: flex; flex-direction: column; height: 100vh; }
        .toolbar { padding: 10px; display: flex; gap: 10px; background: #2d2d2d; align-items: center; }
        button { padding: 8px 15px; border-radius: 4px; border: none; cursor: pointer; font-weight: bold; }
        .launch { background: #00c853; color: white; }
        .kill { background: #ff5252; color: white; }
        .fullscreen { background: #2979ff; color: white; }
        #browser-container { flex-grow: 1; position: relative; background: #000; }
        iframe { width: 100%; height: 100%; border: none; }
    </style>
</head>
<body>

    <div class="toolbar">
        <button class="launch" onclick="launch()">Launch Session</button>
        <button class="fullscreen" onclick="toggleFullscreen()">Fullscreen</button>
        <button class="kill" onclick="kill()">End Session</button>
        <span id="status" style="margin-left: auto; font-size: 0.8em; color: #aaa;">Ready</span>
    </div>

    <div id="browser-container">
        <iframe id="cloud-iframe" src="about:blank"></iframe>
    </div>

    <script>
        const iframe = document.getElementById('cloud-iframe');
        const container = document.getElementById('browser-container');
        const status = document.getElementById('status');

        async function launch() {
            status.innerText = "Provisioning Cloud Browser...";
            const res = await fetch('/api/session');
            const data = await res.json();
            if (data.url) {
                iframe.src = data.url;
                status.innerText = "Connected to Browserless";
            }
        }

        async function kill() {
            await fetch('/api/kill', { method: 'POST' });
            iframe.src = "about:blank";
            status.innerText = "Session Terminated";
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                container.requestFullscreen().catch(err => {
                    alert(`Error: ${err.message}`);
                });
            } else {
                document.exitFullscreen();
            }
        }
    </script>
</body>
</html>

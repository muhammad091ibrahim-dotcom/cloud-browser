<!DOCTYPE html>
<html>
<head>
    <title>Cloud Browser</title>
    <style>
        body { margin: 0; background: #121212; color: white; font-family: sans-serif; height: 100vh; display: flex; flex-direction: column; }
        .nav { padding: 10px; background: #1f1f1f; display: flex; gap: 10px; align-items: center; border-bottom: 1px solid #333; }
        #container { flex: 1; background: #000; position: relative; }
        iframe { width: 100%; height: 100%; border: none; }
        button { padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-start { background: #00e676; color: #000; }
        .btn-fs { background: #2979ff; color: #fff; }
        .btn-stop { background: #ff5252; color: #fff; }
        button:hover { opacity: 0.8; }
    </style>
</head>
<body>

    <div class="nav">
        <button class="btn-start" onclick="startSession()">ðŸš€ Start Browser</button>
        <button class="btn-fs" onclick="goFullscreen()">ðŸ“º Fullscreen</button>
        <button class="btn-stop" onclick="stopSession()">ðŸ›‘ Stop</button>
        <div id="loader" style="display:none; margin-left:10px;">Connecting to cloud...</div>
    </div>

    <div id="container">
        <iframe id="browser-view" src="about:blank"></iframe>
    </div>

    <script>
        const iframe = document.getElementById('browser-view');
        const loader = document.getElementById('loader');

        async function startSession() {
            loader.style.display = 'block';
            try {
                const res = await fetch('/api/session');
                const data = await res.json();
                if (data.url) {
                    iframe.src = data.url;
                }
            } catch (e) { alert("Error connecting to server!"); }
            loader.style.display = 'none';
        }

        async function stopSession() {
            await fetch('/api/kill', { method: 'POST' });
            iframe.src = "about:blank";
        }

        function goFullscreen() {
            const elem = document.getElementById('container');
            if (elem.requestFullscreen) {
                elem.requestFullscreen();
            } else if (elem.webkitRequestFullscreen) { /* Safari */
                elem.webkitRequestFullscreen();
            }
        }
    </script>
</body>
</html>
